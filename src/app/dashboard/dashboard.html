<section class="dashboard">
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="logo">Wekaadoo 💰</div>
    <nav>
      <a (click)="scrollToSection('hero')">🏆 Goals</a>
      <a (click)="scrollToSection('goals')">📜 Activity</a>
      <a (click)="scrollToSection('insights')">📈 Insights</a>
      <a (click)="scrollToSection('badges')">🎖 Badges</a>
      <a (click)="scrollToSection('settings')">⚙ Settings</a>
      <a class="logout">Logout</a>
    </nav>
  </aside>

  <!-- Main Content -->
  <div class="main">
    <!-- Welcome header -->
    <header class="header">
      <div class="greeting">
        <h1>Good Afternoon, {{ userFirstName }} 👋</h1>
        <p class="muted">Ready to crush your saving goals today?</p>
      </div>
      <div class="header-cta">
        <button class="btn primary" (click)="createGoal('New Goal', 1000)">+ New Goal</button>
        <button class="btn ghost" (click)="scrollToSection('settings')">Settings</button>
      </div>
    </header>

    <main class="grid">
      <!-- Hero -->
      <section class="card hero" id="hero">
        <div class="hero-left">
          <!-- Circular Progress -->
          <svg class="radial" viewBox="0 0 150 150" aria-hidden="true">
            <defs>
              <linearGradient id="gMain" x1="0" y1="0" x2="1" y2="1">
                <stop offset="0%" stop-color="#4f9ef7"/>
                <stop offset="100%" stop-color="#57d28d"/>
              </linearGradient>
            </defs>
            <circle cx="75" cy="75" r="60" class="bg-ring"></circle>
            <g transform="rotate(-90 75 75)">
              <circle cx="75" cy="75" r="60"
                      class="progress"
                      [attr.stroke-dasharray]="circleDash(getMainGoal(), 60)">
              </circle>
            </g>
            <text x="75" y="74" text-anchor="middle" class="big-pct">
              {{ getPercent(getMainGoal()) }}%
            </text>
          </svg>
        </div>

        <div class="hero-right">
          <h3>{{ getMainGoal().emoji }} {{ getMainGoal().title }}</h3>
          <p class="muted">ksh{{ formatCurrency(getMainGoal().saved) }} / ksh{{ formatCurrency(getMainGoal().target) }}</p>

          <!-- Add Savings -->
          <div class="actions" *ngIf="getMainGoal().saved < getMainGoal().target">
            <input type="number" min="1" placeholder="Amount" #amt />
            <button class="btn primary" 
                    (click)="addSavings(getMainGoal().id, +amt.value); amt.value=''">
              Add Savings
            </button>
          </div>

          <!-- Stats -->
          <div class="small-stats">
            <div><strong>Total Savings</strong><div>ksh{{ formatCurrency(totalSavings()) }}</div></div>
            <div><strong>This Month</strong><div>ksh{{ formatCurrency(thisMonthSavings()) }}</div></div>
            <div><strong>Next Target</strong><div>ksh{{ formatCurrency(getMainGoal().target - getMainGoal().saved) }}</div></div>
          </div>
        </div>

        <!-- Goals List -->
        <div class="goal-list">
          <div class="goal" *ngFor="let g of goals" [class.completed]="g.saved >= g.target">
            <div class="goal-left">
              <div class="badge-emoji">{{ g.emoji }}</div>
              <div class="goal-info">
                <div class="title">{{ g.title }}</div>
                <div class="muted">ksh{{ formatCurrency(g.saved) }} / ksh{{ formatCurrency(g.target) }}</div>
              </div>
            </div>
            <div class="goal-right">
              <div class="progress-bar">
                <div class="fill" 
                    [style.width.%]="getPercent(g)" 
                    [style.background]="g.color || '#4f9ef7'">
                </div>
              </div>
              <div class="percent">{{ getPercent(g) }}%</div>
            </div>
          </div>
        </div>
      </section>

      <!-- Recent Activity -->
      <section class="card activity" id="activity">
        <h4>Recent Activity</h4>
        <ul>
          <li *ngFor="let a of activities" class="activity-item">
            <div class="act-left">
              <div class="act-text">{{ a.text }}</div>
              <div class="muted small">{{ a.time | date:'short' }}</div>
            </div>
            <div class="act-right">+ksh{{ formatCurrency(a.amount) }}</div>
          </li>
        </ul>
      </section>

      <!-- Insights -->
      <section class="card insights" id="insights">
        <h4>Insights</h4>
        <p class="muted">{{ recommendationText() }}</p>
        <div class="linechart">
          <svg viewBox="0 0 400 120" preserveAspectRatio="none">
            <path [attr.d]="buildLinePath(400,120)" fill="none" class="line"></path>
            <ng-container *ngFor="let val of monthlySavings; index as i">
              <circle [attr.cx]="getCircleX(i)" [attr.cy]="getCircleY(val)" r="4" class="circle-point" />
            </ng-container>
          </svg>
        </div>
      </section>

      <!-- Badges -->
      <section class="card badges" id="badges">
        <h4>Badges</h4>
        <div class="badge-grid">
          <div class="badge" *ngFor="let b of badges" [class.earned]="b.earned">
            <div class="badge-ico">🏅</div>
            <div class="badge-title">{{ b.title }}</div>
          </div>
        </div>
        <div class="quick-actions">
          <button class="btn primary" (click)="createGoal('Dream Fund', 5000)">Create Goal</button>
          <button class="btn ghost">View Reports</button>
        </div>
      </section>

      <!-- Settings -->
      <section class="card" id="settings">
        <h4>Settings</h4>
        <p class="muted">Manage your preferences here.</p>
      </section>
    </main>
  </div>
</section>
